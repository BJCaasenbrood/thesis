%!TEX root = ../../thesis.tex
\noindent In this section, the nonlinear stiffness function for elongation and bending, $k_e: \R \to \Rsp$ and $k_b: \R \to \Rsp$, respectively, are solidified such that the elastic deformation aligns with the physical system (see Figure \ref{fig:C2:soft_robot}). Numerous studies consider these stiffnesses to be linear, however, the presence of exotic materials and complicated structures would justify the modeling of nonlinear elastic behavior. Here, we extend these conservative material models and explore the nonlinear and time-varying regime.

\subsection{Finite element method and hyper-elasticity}
Generally, soft robots are operated by (differential) pressure to air channels embedded in the elastic body. If the applied pressure is sufficiently larger than the ambient pressure, the elastic body deforms to counteract the external forces -- the critical point at which the external force overcome the internal elastic forces is proportional to the Young's modulus of the material.
To enable efficient mobility, soft robots often explore of materials (or material composites) with a low Young's moduli, e.g., silicone elastomers. Unfortunately, large deformations of these rubber-like materials inherently lead to state-dependency in the mechanical compliance, and thus Hookean elasticity is no longer accurate -- rendering them hyper-elastic. These hyper-elastic materials branch a whole new subfield in continuum mechanics. Although analytic descriptions exist, hyper-elasticity is generally treated numerically through Finite Element techniques \cite{Duriez2013,Largilliere2015,Coevoet2017} paired with a (nonlinear) continuum mechanics framework.

Many variations of constitutive models for hyper-elastic materials are available, including Saint Venant-Kirchhoff, Neo-Hookean, Mooney-Rivlin, Ogden, and Yeoh \cite{Meyer2009,Renaud2011,Kim2018}. In Mustaza et al. (2019, \cite{Mustaza2019}), a Yeoh constitutive model is explored to describe hyper-elastic material characteristics of a silicone-composite actuator. Duriez et al.(2013, \cite{Duriez2013}) and related works \cite{Coevoet2017,Largilliere2015} employ Neo-Hookean material models to enrich the nonlinear deformations in FEM-driven models. There are many different constitutive models available, each better suited to describe specific nonlinear elastic behavior. Constitutive material models are mathematical functions used to express the (nonlinear) relationship between stress and strain in terms of deformation. The geometrical deformation of a solid is described by the deformation gradient tensor: \vspace{-3mm}

\begin{equation}
\mat{F}(\xB) := \mat{I}_3 +
\grad{\xB}\vec{d}(\xB)
\end{equation}
%
where $\xB \subseteq \Vs$ is a material point in $\R^3$, and $\vec{U}(\xB,t) \in \R^3$ is the displacement vector. For hyper-elastic materials, it is postulated that there exists a potential energy function $\mat{F} \mapsto \Psi(\mat{F})$ that is a function of the strain tensors. This potential function $\Psi(\mat{F})$ is also referred to as strain-energy density function, which depends exclusively on the material deformation.

In this work, we regard the Saint Venant-Kirchhoff constitutive model for hyper-elasticity. The Saint Venant-Kirchhoff model is in many ways similar to linear elastic materials (\ie, Hooke's law), however, it is an extension from linear deformations into the nonlinear regime. The strain-energy density function for the Saint Venant-Kirchhoff model is defined as
%
\begin{equation}
\Psi^{\textrm{SV}} := \frac{\lambda}{2}\,\trace\,(\ten{E})^2 + \mu\,\trace\,(\ten{E}^2),
\label{eq:C2:mat_model}
\end{equation}
%
\noindent where $\ten{E} = \frac{1}{2}(\mat{F}^\top\mat{F} - \vec{I})$ the Green-Lagrange strain tensor, $\trace(\cdot)$ denotes the trace of a tensor, and $\lambda > 0$ and $\mu > 0$ are the Lam\'{e} parameters which arise from the strain-stress relationships of the elastic material. The relations for the Lam\'{e} parameters are given by
\begin{equation}
%
\lambda = \frac{\nu E_0}{(1+\nu_0)(1-2\nu_0)} \;\; \si{\mega \pascal}, \quad \quad \mu = \frac{E_0}{2(1+\nu_0)} \;\; \si{\mega \pascal};
\label{eq:C2:lame_coeff}
\end{equation}
%
where $E_0$ is the Young's modulus or elasticity modulus and $\nu_0$ is a dimensionless constant denoting the Poisson ratio. It is worth mentioning that the Yeoh or Ogden model is more suitable for silicone elastomer materials that are conventional material models for soft robotics.

In order to invoke the constitutive material law \eqref{eq:C2:mat_model} for three-dimensional solids, we explore the finite element method. We generated a finite element mesh of the soft robot manipulator in Figure \ref{fig:C2:soft_robot}. The finite element analysis has been carried out in \texttt{Abaqus/CEA} with variable time increments. Given preliminary uni-axial tension tests, the 3D-printed elastomer material is estimated to be linear isotropic described by the following Lam\'{e} parameters: $E_0  = 80 \; \si{\mega \pascal}$, $\nu_0 = 0.4 \; (\text{-})$. The Lam\'{e} parameters can be computed according to \eqref{eq:C2:lame_coeff}. Furthermore, tangential (frictionless) contact interaction is included in the numerical simulation to prevent self-intersection of the elastic body.

Two finite element simulations are performed to {independently characterize the elongation and bending stiffness of the soft robot. Due to simplicity, we start with the elongation stiffness}. Each embedded bellow is actuated simultaneously up to a quasi-static differential pressure $-20$ kPa $\le u_1(t) = u_2(t) = u_3(t) \le 30$ kPa. Due to the symmetry of soft actuators, the resulting deformation will be exclusively in axial-direction. The corresponding elongation strain of the soft robot can then be found by recovering the maximum vertical displacement of the nodal mesh, i.e., $\varepsilon = L\inv\max \left( {U}_z \right)$. Secondly, the analysis of the bending stiffness is conducted by actuating a single bellow up to a quasi-static differential pressure $-30$ kPa $\le u_1(t) \le  80$ kPa, while $u_2(t) = u_3(t) = 0$ kPa. To recover the bending angle of the elastic body, certain spatial coordinates of nodes close to the end effector are tracked. Given their global coordinates, a constraint nonlinear optimization \texttt{fmincon.m} is used to recover optimal Bishop parameters $\kappa$ and $\varepsilon
$ subjected to the kinematic relation in \eqref{eq:C2:phi_rodr} and \eqref{eq:C2:pos_exact}.
%
\begin{figure}[!t]
 %\vspace{-3mm}
  \centering
  \input{./3_chapters/2_chapter/img/fig_C2_fembend.tex} \\[1em]
  \input{./3_chapters/2_chapter/img/fig_C2_fembend2.tex}
  \vspace{-0.2cm}
  \caption{Highly-resolution finite element simulations of the soft robot manipulator \data{lightgreen} subjected to various input pressures $-20 \,\si{\kilo \pascal} \le \uB_i(t) \le 80 \,\si{\kilo \pascal}$. To validate the PCC condition, an optimal backbone curve $\gammaB(\q^\star)$ is shown \data{magenta} whose joint coordinates are recovered by solving the optimization problem \eqref{eq:C2:optimization_problem}.}
  \vspace{-0.1cm}
  \label{fig:C2:fem_analysis}
\end{figure}
%
\begin{figure}[!t]
 \vspace{-1mm}
  %\centering
  \hspace{-2mm}
  \input{./3_chapters/2_chapter/img/fig_C2_fem.tex}
  %\includegraphics[width = 0.99\textwidth]{fig_1024x256.pdf}
  \vspace{-0.5cm}
  \caption{Comparison of the (nonlinear) mechanical compliance between the proposed hyper-elastic model \data{Matlab2} and the finite element simulations \data{Matlab1}. Notice the proposed stiffness model \eqref{eq:C2:stiffness_tanh_beta} does not capture the self-collision. }
  \vspace{-0.1cm}
  \label{fig:C2:fem_stress}
\end{figure}
%
\begin{align}
\q^\star & = \underset{\q}{\textrm{argmin}}\;  \left \lVert \log_{\SE{3}}\left[ \gB\inv(L,\q)\,\gB_L^{\textrm{FEM}}(\vec{u}) \right] \right \rVert_2,
\label{eq:C2:optimization_problem}
\end{align}
%
where $\gB_L^{\textrm{FEM}}$ is simply the corresponding end-effector configuration derived from the high-resolution finite element simulation given the input $\uB$. To some extent, \eqref{eq:C2:optimization_problem} can be viewed as an inverse kinematics optimization problem.
\vfill

\begin{rmk} Although straightforward for constant curvature soft-links, the approach could be easily extended to non-constant curvature and multi-link cases. However, an additional term $\Uf^\star = \tfrac{1}{2} \q^\top\mat{K}\q$ with some positive definite matrix $\mat{K} \succ 0 $ is required to ensure the nonlinear regression inhibits over-fitting.
\end{rmk}

Following the PCC condition, the bending angle $\beta$ can be calculated straightforwardly. Given these geometric curve parameters and the effective areas of the bellows, the applied elongation force and bending torque can be computed accordingly.

The numerical results are provided in Figure \ref{fig:C2:fem_stress}. In practice, these nonlinear strain relations can also be determined experimentally; however, the numerical methods have the beneficial convenience of several post-processing procedures and gravitation-free deformations. To support our previous claim concerning the consistency of the PCC condition, Figure \ref{fig:C2:fem_analysis} provides a few FEM snapshots results together with the optimal backbone curve from \eqref{eq:C2:pos_exact}. It can be seen that the piece-wise constant curvature (PCC) condition, although a clear oversimplification of the true mechanics at hand, is remarkably consistent with the FEM simulations.
%w
\begin{table}[!t]
\caption{Estimated hyper-elastic and visco-elastic material parameters for the study case soft robot \label{tab:C2:elastic_parameters}}
\centering
\begin{tabular}{ccccccc}
\hline
& $i=1$ &  $i=2$ &  $i=3$ & $i=4$ &  $i=5$ & $i=6$ \\
\hline
\hline
$\alpha$ &  \small{2.23}$\pwr{+3}$  & \small{1.74}$\pwr{+3}$  &  \small{-4.55}$\pwr{+2}$ & \small{1.31}$\pwr{-3}$  & \small{1.23}$\pwr{-2}$ & \small{-2.29}$\pwr{-1}$ \\[0.15em]
 $\alpha_\lambda$ &  \small{3.21}$\pwr{+2}$ & \small{5.22}$\pwr{-1}$ &  \small{26.4}$\pwr{+1}$& \small{1.82}$\pwr{-4}$ & \small{26.4}$\pwr{+1}$ & \small{1.82}$\pwr{-4}$ \\
\hline
\end{tabular}
\vspace{-3mm}
\end{table}
%
\subsection{Hyper-elasticity on joint space}
\noindent From the finite element results in Figure \ref{fig:C2:fem_analysis}, the mathematical description for the nonlinear stiffness can be detailed further. However, a suitable candidate function must be chosen first to properly represent the hyper-elastic stress-strain relation. The stiffness function $k_e (\varepsilon)$ and $k_b (\beta)$  have to satisfy the following properties.
%
\begin{asm}[Elastic boundedness]
\label{asm:C2:elastic_boundedness}
There exists positive constants ${k}^{-}$ and ${k}^{+}$ such that ${k}^{-} \le k_e(\xi),k_b(\xi) \le {k}^{+}$ for all possible strains $\xi \in \R$.
\end{asm}
%
\begin{asm}[Deformations reversibility]
\label{asm:C2:elastic_reversibility}
The stiffness functions $k_e(\xi)$ and $k_b(\xi)$ must have a global optimum (i.e., either a maximum or minimum) at their origin. As a result, the force produced by any deformation, given by ${\Ft} = \int_0^\xi k(s)s\;ds$, must be a monotonically increasing function where $\Ft = 0$ for the origin.
\end{asm}
%
Assumption \ref{asm:C2:elastic_boundedness} and \ref{asm:C2:elastic_reversibility} are necessary since they inhibit any elasto-plastic behavior, \ie, elastic bodies undergoing non-reversible deformation due to applied forces. Then. consider the following elasticity models for the nonlinear (hyper-elastic) elongation and bending stiffness:
%
\begin{align}
\label{eq:C2:stiffness_tanh_eps}
{k}_e(\q) & = \alpha_1 + \alpha_2 \left( \tanh[\alpha_3\,\varepsilon]^2 - 1 \right), \\[0.5em]
\label{eq:C2:stiffness_tanh_beta}
{k}_b(\q)  & = \alpha_{\phi}(\q) \cdot \left[\alpha_4 + \alpha_5 \left( \tanh[\alpha_6\,\beta]^2 - 1 \right)\right],
\end{align}
%
where $\vec{\alpha} = \left(\alpha_1,\,\alpha_2,\,\alpha_3,\alpha_4,\,\alpha_5,\,\alpha_6 \right)^\top$ is a vector composed of the (possibly time-varying) stiffness parameters, and $\alpha_\phi: \mathcal{Q} \to [1,\infty)$ a nonlinear correction term for asymmetry along the circumference of the radial-axis. Please note that these nonlinear functions possess a decomposable structure: a linear term and a nonlinear term that mimics strain-hardening or strain-softening. As for the asymmetric stiffness due to the layout of the pneumatic bellows, we propose the following ansatz:
%
\begin{asm}[Stiffness variation under radial offset]
Given the radial layout of the pneumatic bellows of the soft robot (see Figure \ref{fig:C2:soft_robot}), we assume that the nonlinear correction term for asymmetric radial stiffness along the circumference can be modeled by:
%
\begin{equation}
\alpha_\phi (\q) = \frac{1}{2}\beta \left[\sin( m \,\phi) + 1 \right] + 1,
\end{equation}
%
where $m$ is the number of bellows, and $\phi = \text{atan2}(\kappa_y,\kappa_x)$ the direction angle or heading. This stiffness correction term ensures the nonlinear bending stiffness becomes larger between bellows -- as it causes simultaneous deformation of multiple bellows. Please note that $\alpha_\phi(\q) \ge 1$ for all $\q \in \mathcal{Q}$.
\end{asm}

\begin{figure}[!t]
 \vspace{-3mm}
  \centering
  \input{./3_chapters/2_chapter/img/fig_C2_stiffness.tex}
  \vspace{-0.25cm}
  \caption{Spatial representation of the nonlinear stiffness, \ie,  elongation stiffness (left) and bending stiffness (right), for an radially distributed sampling of the curvature joint space $(\kappa_x,\,\kappa_y) \in (-\pi,\pi]$. Note that the bending stiffness }
  \vspace{-0.1cm}
  \label{fig:C2:stiffness_model}
\end{figure}

To satisfy the aforementioned conditions, it should hold that $\alpha_1 > \alpha_2 $, $\alpha_4 > \alpha_5$ and $\alpha_{1,4} > 0$. Using a weighted least-squarest optimization, the nonlinear stiffness parameter vector $\vec{\alpha}$ can be identified. The estimated hyper-elastic material parameters are shown in Table \ref{tab:C2:elastic_parameters}. Furthermore, the weighted regression is biased towards positive strains, to better represent the deformation characteristics under positive pressurization. Theoretically, the self-contact interactions (as seen in Figure \ref{fig:C2:fem_analysis}) can also be parameterized using a different set of (convex) non-zero polynomials, similar to the functions \eqref{eq:C2:stiffness_tanh_eps} and
\eqref{eq:C2:stiffness_tanh_beta}.

\subsection{Visco-elastic creep}
\noindent In material mechanics, the tendency of mechanical solids to move slowly under stress is called creep. Unlike ideal elastic materials, when polymeric materials are subjected to abrupt change in stress, the constitutive network of polymer chains reconfigure until the stress is evenly distrusted. Therefore, let us introduce a new state vector $\vec{\lambda}(t)\in \mathbb{R}^n$, which contains the creep state variables. According to Meyer et al. (2009, \cite{Meyer2009}), the Kelvin-Voigt model for creep is given by a first-order ordinary differential equation of the form

 \begin{align}
\dvec{\lambda} & = -\begin{pmatrix} \alpha_{\lambda,1} & \hdots & 0 \\
\vdots & \ddots & \vdots  \\ 0 & \hdots & \alpha_{\lambda,2n-1} \end{pmatrix} \begin{pmatrix} \lambda_1 \\ \vdots \\ \lambda_n \end{pmatrix} -\begin{pmatrix} \alpha_{\lambda,2} \\ \vdots \\ \alpha_{\lambda,2n} \end{pmatrix} \dq
  \end{align}
 %
%
\noindent where the vector $\vec{\alpha}_\lambda = (\alpha_{\lambda,1},\,\alpha_{\lambda,2},\,...,\,\alpha_{\lambda,2n})^\top$ contains positive parameters that describe the visco-elastic material dynamics, and the state variables $\lambda_i(t)$ with $i \in \{1,2,...,n\}$,  \ie, the creep strains. Note that the state dimension of the creep strains is equivalent to the state dimension $\dim(\q)$. Now, the dynamics of the visco-elastic creep can be intuitively included into
\eqref{eq:C2:dynamic_model} as an external disturbance $\vec{\delta}(t)$. Hence, consider the visco-elastic creep forces of the Kelvin-Voigt model to be characterized by
%
\begin{equation}
\vec{\delta}_c({\vec{\lambda}}) = \mat{K}_{\lambda}^\top \vec{\lambda},
\end{equation}
%
\noindent where $\mat{K}_\lambda$ denotes the creep compliance matrix, which is a linear mapping from creep strains to creep forces. Since creeping strain are difficult, if not impossible, to distinguish from the elastic strains, the creeping parameters $\vec{\alpha}_\lambda$ and the creep compliance $\mat{K}_\lambda$ are empirically identified from experimental data (e.g., unforced oscillations) by using least-squares regressions. The estimated visco-elastic parameters are also found in Table \ref{tab:C2:elastic_parameters}. The linear damping parameters from the Rayleigh dampings matrix $\mat{R}$ and the initial conditions for $\vec{\lambda}(t_0)$ are identified similarly.

\begin{example}[Kelvin-Voigt creep dynamics] To highlight the dynamics of elastomer materials exhibiting creep, let us consider an rudimentary illustrative example of a 1-DOF mass-spring-damper system with a Kelvin-Voigt creep element. Let $\xB = (x_1,\,x_2,\,x_3)^\top = (\varepsilon,\, \dot{\varepsilon},\, \lambda)^\top$ be the state vector composed of the elongation strain, elongation rate, and the creep strain, respectively. Then, the dynamics can be written in the familiar state space form as follows:
%
\begin{align}
\dot{x}_1 & = x_1, \\
\dot{x}_2 & = \frac{1}{m}\left[ -k x_1 - c x_2 + k_\lambda x_3 + u \right], \\
\dot{x}_3 & = -\alpha_{\lambda,1}x_3 -\alpha_{\lambda,2}x_2
\end{align}
%
where $m,k,c>0$  the mass, spring, damper coefficients; respectively, $k_{\lambda}>0$ the creep stiffness, $\alpha_{\lambda}>0$ the creep parameters, and $u: \Ts \to \R$ an auxiliary input (\ie, prescribed force). The following parameters are consider for this illustrative example: $m = 0.1$ \si{\kilo \gram}, $k = 10$ Nm$\inv$, $c = 0.1$ Nsm$\inv$,
$k_{\lambda} = \alpha_{\lambda,1} = 2$, and $\alpha_{\lambda,2} = 5$. By choosing a smooth block signal as input $u(t)$, we obtained the simulation results as shown in Figure \ref{fig:C2:creep}. Note that the simulation result presents an unmodified Hookean model \data{Matlab1}, \ie, $k_\lambda = 0$, and the Kelvin-Voight variant \data{Matlab2}.

Clearly, we see a difference between the two trajectories. The original Hookean model oscillates around the quasi-static equilibrium, whereas the Kelvin-Voight variant slowly converges to the setpoint. Note that this is clearly different than over-damped response, as the Kelvin-Voight model does allow for oscillations. %Intuitively, visco-elastic creep can be seen as a mechanical memory that resists changes in deformation.
%
\begin{figure}[!h]
 \vspace{-1mm}
  %\centering
  \input{./3_chapters/2_chapter/img/fig_C2_creep.tex}
  \vspace{-0.2cm}
  \caption{Simulation study of introducing visco-elastic Kelvin-Voigt dynamics to a mass-spring-damper system, where we show the evolution of the elongation $\varepsilon$ subjected to an smooth block signal $u(t)$ in \data{lightgrey} compared between the original Hookean model \data{Matlab1} and visco-elastic Hookean model \data{Matlab2}. Also, the evolution of the visco-elastic creeping strain $\lambda$ is shown in \data{Matlab3}.}
  \vspace{-0.1cm}
  \label{fig:C2:creep}
\end{figure}

\end{example}
